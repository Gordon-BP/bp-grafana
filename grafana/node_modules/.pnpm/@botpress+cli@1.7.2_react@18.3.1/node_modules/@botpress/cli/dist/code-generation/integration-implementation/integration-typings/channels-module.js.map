{
  "version": 3,
  "sources": ["../../../../src/code-generation/integration-implementation/integration-typings/channels-module.ts"],
  "sourcesContent": ["import * as sdk from '@botpress/sdk'\nimport { GENERATED_HEADER, INDEX_FILE } from '../../consts'\nimport { zuiSchemaToTypeScriptType, stringifySingleLine } from '../../generators'\nimport { Module, ReExportTypeModule } from '../../module'\nimport * as strings from '../../strings'\n\nclass MessageModule extends Module {\n  public constructor(name: string, private _message: sdk.MessageDefinition) {\n    super({\n      path: `${name}.ts`,\n      exportName: strings.typeName(name),\n    })\n  }\n\n  public async getContent() {\n    return zuiSchemaToTypeScriptType(this._message.schema, this.exportName)\n  }\n}\n\nclass MessagesModule extends ReExportTypeModule {\n  public constructor(channel: sdk.ChannelDefinition) {\n    super({ exportName: strings.typeName('messages') })\n    for (const [messageName, message] of Object.entries(channel.messages ?? {})) {\n      const module = new MessageModule(messageName, message)\n      this.pushDep(module)\n    }\n  }\n}\n\nclass ChannelModule extends Module {\n  private _messagesModule: MessagesModule\n\n  public constructor(channelName: string, private _channel: sdk.ChannelDefinition) {\n    super({\n      path: INDEX_FILE,\n      exportName: strings.typeName(channelName),\n    })\n\n    this._messagesModule = new MessagesModule(_channel)\n    this._messagesModule.unshift('messages')\n    this.pushDep(this._messagesModule)\n  }\n\n  public async getContent() {\n    const messageImport = this._messagesModule.import(this)\n\n    const conversation = {\n      tags: this._channel.conversation?.tags ?? {},\n      creation: this._channel.conversation?.creation ?? { enabled: false, requiredTags: [] },\n    }\n\n    const message = {\n      tags: this._channel.message?.tags ?? {},\n    }\n\n    return [\n      GENERATED_HEADER,\n      `import { ${this._messagesModule.exportName} } from './${messageImport}'`,\n      `export * from './${messageImport}'`,\n      '',\n      `export type ${this.exportName} = {`,\n      `  messages: ${this._messagesModule.exportName}`,\n      `  message: ${stringifySingleLine(message)}`,\n      `  conversation: ${stringifySingleLine(conversation)}`,\n      '}',\n    ].join('\\n')\n  }\n}\n\nexport class ChannelsModule extends ReExportTypeModule {\n  public constructor(channels: Record<string, sdk.ChannelDefinition>) {\n    super({ exportName: strings.typeName('channels') })\n    for (const [channelName, channel] of Object.entries(channels)) {\n      const module = new ChannelModule(channelName, channel)\n      module.unshift(channelName)\n      this.pushDep(module)\n    }\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,oBAA6C;AAC7C,wBAA+D;AAC/D,oBAA2C;AAC3C,cAAyB;AAEzB,MAAM,sBAAsB,qBAAO;AAAA,EAC1B,YAAY,MAAsB,UAAiC;AACxE,UAAM;AAAA,MACJ,MAAM,GAAG;AAAA,MACT,YAAY,QAAQ,SAAS,IAAI;AAAA,IACnC,CAAC;AAJsC;AAAA,EAKzC;AAAA,EAEA,MAAa,aAAa;AACxB,eAAO,6CAA0B,KAAK,SAAS,QAAQ,KAAK,UAAU;AAAA,EACxE;AACF;AAEA,MAAM,uBAAuB,iCAAmB;AAAA,EACvC,YAAY,SAAgC;AACjD,UAAM,EAAE,YAAY,QAAQ,SAAS,UAAU,EAAE,CAAC;AAClD,eAAW,CAAC,aAAa,OAAO,KAAK,OAAO,QAAQ,QAAQ,YAAY,CAAC,CAAC,GAAG;AAC3E,YAAMA,UAAS,IAAI,cAAc,aAAa,OAAO;AACrD,WAAK,QAAQA,OAAM;AAAA,IACrB;AAAA,EACF;AACF;AAEA,MAAM,sBAAsB,qBAAO;AAAA,EAG1B,YAAY,aAA6B,UAAiC;AAC/E,UAAM;AAAA,MACJ,MAAM;AAAA,MACN,YAAY,QAAQ,SAAS,WAAW;AAAA,IAC1C,CAAC;AAJ6C;AAM9C,SAAK,kBAAkB,IAAI,eAAe,QAAQ;AAClD,SAAK,gBAAgB,QAAQ,UAAU;AACvC,SAAK,QAAQ,KAAK,eAAe;AAAA,EACnC;AAAA,EAXQ;AAAA,EAaR,MAAa,aAAa;AACxB,UAAM,gBAAgB,KAAK,gBAAgB,OAAO,IAAI;AAEtD,UAAM,eAAe;AAAA,MACnB,MAAM,KAAK,SAAS,cAAc,QAAQ,CAAC;AAAA,MAC3C,UAAU,KAAK,SAAS,cAAc,YAAY,EAAE,SAAS,OAAO,cAAc,CAAC,EAAE;AAAA,IACvF;AAEA,UAAM,UAAU;AAAA,MACd,MAAM,KAAK,SAAS,SAAS,QAAQ,CAAC;AAAA,IACxC;AAEA,WAAO;AAAA,MACL;AAAA,MACA,YAAY,KAAK,gBAAgB,wBAAwB;AAAA,MACzD,oBAAoB;AAAA,MACpB;AAAA,MACA,eAAe,KAAK;AAAA,MACpB,eAAe,KAAK,gBAAgB;AAAA,MACpC,kBAAc,uCAAoB,OAAO;AAAA,MACzC,uBAAmB,uCAAoB,YAAY;AAAA,MACnD;AAAA,IACF,EAAE,KAAK,IAAI;AAAA,EACb;AACF;AAEO,MAAM,uBAAuB,iCAAmB;AAAA,EAC9C,YAAY,UAAiD;AAClE,UAAM,EAAE,YAAY,QAAQ,SAAS,UAAU,EAAE,CAAC;AAClD,eAAW,CAAC,aAAa,OAAO,KAAK,OAAO,QAAQ,QAAQ,GAAG;AAC7D,YAAMA,UAAS,IAAI,cAAc,aAAa,OAAO;AACrD,MAAAA,QAAO,QAAQ,WAAW;AAC1B,WAAK,QAAQA,OAAM;AAAA,IACrB;AAAA,EACF;AACF;",
  "names": ["module"]
}
