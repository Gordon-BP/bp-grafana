{
  "version": 3,
  "sources": ["../../../src/code-generation/plugin-implementation/plugin-implementation.ts"],
  "sourcesContent": ["import * as sdk from '@botpress/sdk'\nimport * as consts from '../consts'\nimport { Module } from '../module'\nimport { PluginTypingsModule } from './plugin-typings'\n\nexport class PluginImplementationModule extends Module {\n  private _typingsModule: PluginTypingsModule\n\n  public constructor(plugin: sdk.PluginDefinition) {\n    super({\n      exportName: 'Plugin',\n      path: consts.INDEX_FILE,\n    })\n\n    this._typingsModule = new PluginTypingsModule(plugin)\n    this._typingsModule.unshift('typings')\n    this.pushDep(this._typingsModule)\n  }\n\n  public async getContent() {\n    const typingsImport = this._typingsModule.import(this)\n\n    return [\n      consts.GENERATED_HEADER,\n      'import * as sdk from \"@botpress/sdk\"',\n      `import * as ${this._typingsModule.name} from \"./${typingsImport}\"`,\n      `export * from \"./${typingsImport}\"`,\n      '',\n      `type TPlugin = sdk.DefaultPlugin<${this._typingsModule.name}.${this._typingsModule.exportName}>`,\n      '',\n      'export class Plugin extends sdk.Plugin<TPlugin> {}',\n      '',\n      '// extra types',\n      '',\n      'type AsyncFunction = (...args: any[]) => Promise<any>',\n      'export type EventHandlers = Required<{',\n      \"  [K in keyof Plugin['eventHandlers']]: NonNullable<Plugin['eventHandlers'][K]>[number]\",\n      '}>',\n      'export type MessageHandlers = Required<{',\n      \"  [K in keyof Plugin['messageHandlers']]: NonNullable<Plugin['messageHandlers'][K]>[number]\",\n      '}>',\n      '',\n      \"export type MessageHandlerProps = Parameters<MessageHandlers['*']>[0]\",\n      \"export type EventHandlerProps = Parameters<EventHandlers['*']>[0]\",\n      '',\n      \"export type Client = (MessageHandlerProps | EventHandlerProps)['client']\",\n      'export type ClientOperation = keyof {',\n      '  [K in keyof Client as Client[K] extends AsyncFunction ? K : never]: null',\n      '}',\n      'export type ClientInputs = {',\n      '  [K in ClientOperation]: Parameters<Client[K]>[0]',\n      '}',\n      'export type ClientOutputs = {',\n      '  [K in ClientOperation]: Awaited<ReturnType<Client[K]>>',\n      '}',\n    ].join('\\n')\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,aAAwB;AACxB,oBAAuB;AACvB,4BAAoC;AAE7B,MAAM,mCAAmC,qBAAO;AAAA,EAC7C;AAAA,EAED,YAAY,QAA8B;AAC/C,UAAM;AAAA,MACJ,YAAY;AAAA,MACZ,MAAM,OAAO;AAAA,IACf,CAAC;AAED,SAAK,iBAAiB,IAAI,0CAAoB,MAAM;AACpD,SAAK,eAAe,QAAQ,SAAS;AACrC,SAAK,QAAQ,KAAK,cAAc;AAAA,EAClC;AAAA,EAEA,MAAa,aAAa;AACxB,UAAM,gBAAgB,KAAK,eAAe,OAAO,IAAI;AAErD,WAAO;AAAA,MACL,OAAO;AAAA,MACP;AAAA,MACA,eAAe,KAAK,eAAe,gBAAgB;AAAA,MACnD,oBAAoB;AAAA,MACpB;AAAA,MACA,oCAAoC,KAAK,eAAe,QAAQ,KAAK,eAAe;AAAA,MACpF;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF,EAAE,KAAK,IAAI;AAAA,EACb;AACF;",
  "names": []
}
